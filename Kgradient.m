function [dkpg,dkdg]=Kgradient(g,w,tau)
b1=0.4; b0=6; a1=1;a0=6;
dkpg=exp(1).^((-1).*g.*tau).*((b0+(-1).*b1.*g).^2+b1.^2.*w.^2).^(-2).*((-2).* ...
  b1.^2.*(g.^2+w.^2).*(w.*(a0.*b0+g.*((-2).*a1.*b0+3.*b0.*g+a1.*b1.*g+(-2) ...
  .*b1.*g.^2)+(-1).*(b0+(-1).*a1.*b1+2.*b1.*g).*w.^2).*cos(tau.*w)+(-1).*( ...
  g.*(b0+(-1).*b1.*g).*(a0+g.*((-1).*a1+g))+((-1).*a0.*b1+(-3).*b0.*g+a1.* ...
  (b0+b1.*g)).*w.^2+b1.*w.^4).*sin(tau.*w))+2.*((b0+(-1).*b1.*g).^2+ ...
  b1.^2.*w.^2).*(w.*(a0.*b0+g.*((-2).*a1.*b0+3.*b0.*g+a1.*b1.*g+(-2).*b1.* ...
  g.^2)+(-1).*(b0+(-1).*a1.*b1+2.*b1.*g).*w.^2).*cos(tau.*w)+(-1).*(g.*( ...
  b0+(-1).*b1.*g).*(a0+g.*((-1).*a1+g))+((-1).*a0.*b1+(-3).*b0.*g+a1.*(b0+ ...
  b1.*g)).*w.^2+b1.*w.^4).*sin(tau.*w))+w.^(-2).*(g.^2+w.^2).*((b0+(-1).* ...
  b1.*g).^2+b1.^2.*w.^2).*(w.*((-1).*a0.*b0+g.*(2.*a1.*b0+(-3).*b0.*g+(-1) ...
  .*a1.*b1.*g+2.*b1.*g.^2)+(b0+(-1).*a1.*b1+2.*b1.*g).*w.^2).*cos(tau.*w)+ ...
  (g.*(b0+(-1).*b1.*g).*(a0+g.*((-1).*a1+g))+((-1).*a0.*b1+(-3).*b0.*g+ ...
  a1.*(b0+b1.*g)).*w.^2+b1.*w.^4).*sin(tau.*w))+w.^(-1).*(g.^2+w.^2).*(( ...
  b0+(-1).*b1.*g).^2+b1.^2.*w.^2).*((g.*((-2).*a1.*b0+3.*b0.*g+a1.*b1.*g+( ...
  -2).*b1.*g.^2+(a1+(-1).*g).*g.*(b0+(-1).*b1.*g).*tau)+(-1).*(b0.*(3+a1.* ...
  tau+(-3).*g.*tau)+b1.*((-3).*a1+6.*g+a1.*g.*tau)).*w.^2+(-1).*b1.*tau.* ...
  w.^4+a0.*(b0+(-1).*b0.*g.*tau+b1.*tau.*(g.^2+w.^2))).*cos(tau.*w)+(-1).* ...
  w.*((-2).*a0.*b1+b0.*(a0.*tau+3.*g.*((-2)+g.*tau)+(-1).*tau.*w.^2)+a1.*( ...
  b0.*(2+(-2).*g.*tau)+b1.*g.*(2+g.*tau)+b1.*tau.*w.^2)+(-2).*b1.*(g.^3.* ...
  tau+((-2)+g.*tau).*w.^2)).*sin(tau.*w)));
dkdg=exp(1).^((-1).*g.*tau).*w.^(-2).*((b0+(-1).*b1.*g).^2+b1.^2.*w.^2).^(-2) ...
  .*(w.*(g.^2.*((-1).*b0+b1.*g).^3.*(a0+g.*((-1).*a1+g)).*tau+(-1).*(2.*(( ...
  -1).*a1.*b0.^3+a0.*b0.^2.*b1+g.*(2.*b0+(-1).*b1.*g).*(2.*b0.^2+(-2).* ...
  b0.*b1.*g+b1.^2.*g.^2))+(-1).*(b0+(-1).*b1.*g).*(a0.*b0.^2+(-3).*a1.* ...
  b0.^2.*g+(6.*b0.^2+3.*a1.*b0.*b1+(-2).*a0.*b1.^2).*g.^2+b1.*((-8).*b0+ ...
  a1.*b1).*g.^3+b1.^2.*g.^4).*tau).*w.^2+(4.*b1.*(b0+(-1).*b1.*g).^2+((-1) ...
  .*b0.^3+b0.^2.*b1.*(a1+(-1).*g)+b1.^3.*g.*(a0+(a1+(-5).*g).*g)+b0.* ...
  b1.^2.*(a0+g.*((-5).*a1+11.*g))).*tau).*w.^4+b1.^2.*((-1).*b0.*tau+b1.*( ...
  2+a1.*tau+(-3).*g.*tau)).*w.^6).*cos(tau.*w)+(g.^2.*(b0+(-1).*b1.*g) ...
  .^3.*(a0+g.*((-1).*a1+g))+(-1).*(b0+(-1).*b1.*g).*((-1).*a0.*b0.^2+3.* ...
  a1.*b0.^2.*g+(-6).*b0.^2.*g.^2+(-3).*a1.*b0.*b1.*g.^2+(-2).*a0.*b1.^2.* ...
  g.^2+8.*b0.*b1.*g.^3+3.*a1.*b1.^2.*g.^3+(-5).*b1.^2.*g.^4+g.*((-1).*b0+ ...
  b1.*g).*(a0.*((-2).*b0+b1.*g)+g.*(3.*a1.*b0+(-4).*b0.*g+(-2).*a1.*b1.*g+ ...
  3.*b1.*g.^2)).*tau).*w.^2+(-1).*(b0.^3.*(3+a1.*tau+(-4).*g.*tau)+b0.^2.* ...
  b1.*((-3).*a1+3.*g+(-1).*a0.*tau+6.*g.^2.*tau)+b1.^3.*g.*(a0+(-2).*a0.* ...
  g.*tau+g.*((-3).*a1+7.*g+(4.*a1+(-5).*g).*g.*tau))+b0.*b1.^2.*(a0+4.* ...
  a0.*g.*tau+g.*(a1.*(3+(-6).*g.*tau)+g.*((-9)+4.*g.*tau)))).*w.^4+b1.*(( ...
  -1).*b0.^2.*tau+(-1).*b0.*b1.*(1+a1.*tau+(-6).*g.*tau)+b1.^2.*(a1+(-3).* ...
  g+(-2).*a1.*g.*tau+(a0+g.^2).*tau)).*w.^6+(-1).*b1.^3.*tau.*w.^8).*sin( ...
  tau.*w));   
end